<div th:fragment="frag_index_content"  class="content-wrapper">
<div class="col-12">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">ğŸ“… ë‹¤ì´ì–´ë¦¬ ëª©ë¡</h3>

        <div class="card-tools">
         
          
          <form method="get" th:action="@{/diary/list2}" id="searchForm">
                  <!--/* ê²€ìƒ‰ì–´ ìœ ì§€ */-->
                  <input type="hidden" id="keyword" name="keyword" th:value="${keyword}">
                  <!--/* í˜ì´ì§€ê°’ ìœ ì§€ */-->
                  <input type="hidden" id="page" name="page" th:value="${paging.number}">
                  <div class="input-group input-group-sm" style="width: 150px;">
                    <!--ê²€ìƒ‰ì–´ ì…ë ¥íŒŒíŠ¸, í™”ë©´ì— ë…¸ì¶œë˜ëŠ” ì˜ì—­-->
                    <input type="text" id="search_keyword" th:value="${keyword}" class="form-control float-right"
                      placeholder="Search">
                    <div class="input-group-append">
                      <button type="submit" class="btn btn-default" id="searchBtn">
                        <i class="fas fa-search"></i>
                      </button>
                      &emsp;<a th:href="@{/diary/create}">âœ&ensp;</a>
                    </div>
                  </div>
                   
                </form>
          
        </div>
      </div>
      <!-- /.card-header -->
      <div class="card-body table-responsive p-0">
        <table class="table table-head-fixed text-nowrap">
          <thead>
            <tr>
              <th>ê•¤</th>
              <th>ì œëª©</th>
              <th>ì‘ì„±ì¼</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="diary, idx: ${paging}">
              <td>[[${idx.count}]]</td>
              <td>
              <a th:href="@{|/diary/detail/${ diary.id }|}" th:text="${diary.subject}"></a>
              </td>
              <td>
              <a th:text="${ #temporals.format( diary.getCreateDate(), 'yyyy-MM-dd HH:mm')}"></a>
              </td>
            </tr>

          </tbody>
        </table>
      </div>
      
      <div class="card-footer clearfix">
              <ul class="pagination pagination-sm m-0 float-right">
                <!--/* ì´ì „, 1í˜ì´ì§€ì”© ì‰¬í”„íŠ¸, ì´ì „í˜ì´ì§€ê°€ ì—†ë‹¤ë©´ ë¹„í™œì„±ì²˜ë¦¬(disabled ì†ì„±) */-->
                <li class="page-item" th:classappend="${ !paging.hasPrevious } ? 'disabled'">
                  <!-- <a class="page-link" th:href="@{|?page=${ paging.number-1 }|}">Â«</a> -->
                  <!-- javascript:void(0) : a ìš”ì†Œì˜ ì´ë²¤íŠ¸ ë¬´íš¨í™”(ë§í¬ê¸°ëŠ¥), 
                 ìŠ¤í¬ë¦½íŠ¸ì— ë“±ë¡ëœ ì´ë²¤íŠ¸(click)ë¡œ ì „ë‹¬, ë°ì´í„°ëŠ” data-page ì„¤ì •ëœ ê°’ì„ ê°€ì ¸ê°„ë‹¤ -->
                  <a class="page-link" href="javascript:void(0)" th:data-page="${ paging.number-1 }">
                    <span>Â«</span>
                  </a>
                </li>

                <!--/* 
						- ì´ë™ê°€ëŠ¥í•œ í˜ì´ì§€ ë²ˆí˜¸ ë‚˜ì—´, ì „ì²´ë‚˜ì—´ -> ì œì‹œí•œ í˜ì´ì§€ ê¸°ì¤€, ì•ì— 5ê°œ, ìœ„ì— 5ê°œ
						- ë¡œì§ì€ ë‹¤ì–‘í•˜ê²Œ êµ¬ì‚¬ ê°€ëŠ¥
						- í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸ëŠ”ëŠ” ì¡°ê¸ˆ ë‹¤ë¥´ê²Œ ë¬˜ì‚¬(ë‘ê»ê²Œ, ìƒ‰ìƒì„ ë‹¤ë¥´ê²Œ ë“±ë“±..)
						- ë…¸ì¶œëœí˜ì´ì§€ ë²ˆí˜¸ ì¡°ê±´
							- í˜„ì¬í˜ì´ì§€ê°’ì´ í˜„ì¬í˜ì´ì§€-5 ì´ìƒì´ê³ (and, &&), í˜„ì¬í˜ì´ì§€+5 ì´í•˜ì¸ ê²½ìš°ë§Œ í¬í•¨
							- page >= paging.number-5 and page <= paging.number+5
							- page >= paging.number-5 and paging.number+5 >= page
					 */-->
                <li th:each="page : ${ #numbers.sequence(0, paging.totalPages-1) }"
                  th:classappend="${page == paging.number} ? 'active' "
                  th:if="${ paging.number-5 <= page and page <= paging.number+5 }" class="page-item">
                  <!-- <a class="page-link" th:href="@{|?page=${ page }|}" th:text="${page+1}"></a> -->
                  <a class="page-link" 
                     href="javascript:void(0)" 
                     th:data-page="${ page }" 
                     th:text="${page+1}"></a>
                </li>

                <!--/* ë‹¤ìŒ */-->
                <li class="page-item" th:classappend="${ !paging.hasNext } ? 'disabled'">
                  <!-- <a class="page-link" th:href="@{|?page=${ paging.number+1 }|}">Â»</a> -->
                  <a class="page-link" href="javascript:void(0)" th:data-page="${ paging.number+1 }">
                    <span>Â»</span>
                  </a>
                </li>
              </ul>
            </div>
          </div>
      
    </div>
    <!-- /.card -->
     <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‚½ì… -->
  <script type="text/javascript">
    // js ë³€ìˆ˜ í‘œê¸°: í‚¤ì›Œë“œ(var(ë³€ìˆ˜), let(ë³€ìˆ˜), const(ìƒìˆ˜)) ë³€ìˆ˜ëª…
    // jsì˜ ë³€ìˆ˜ íƒ€ì…ì€ ì–¸ì œ ì„¸íŒ…? => ê°’ì´ ì„¸íŒ…ë˜ë©´ ê·¸ë•Œ íƒ€ì…ì´ ê²°ì •ë¨
    // ìˆœìˆ˜ jsë¡œ ê¸°ìˆ 

    // ì´ì „ 1,2,3,... ë‹¤ìŒ -> í˜ì´ì§• ë§í¬ ìš”ì†Œ -> ê³µí†µì ìœ¼ë¡œ class ê°’ì´ page-link ì˜€ë‹¤
    // í˜„ ë¬¸ì„œìƒì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  ìš”ì†Œë“¤ ì¤‘ì—, í´ë ˆìŠ¤ ê°’ì´  page-link ëª¨ë“  ìš”ì†Œë¥¼ ë‹¤ ì°¾ì•„ë¼
    // subject.getElementsByClassName("page-link"); => $(".page-link");
    const links = document.getElementsByClassName("page-link");
    console.log("í˜ì´ì§• ìš”ì†Œì˜ ê°œìˆ˜", links.length);
    // ë°°ì—´ì—ì„œ í•˜ë‚˜ì”© êº¼ë‚´ì„œ í´ë¦­ì´ë²¤íŠ¸ ë“±ë¡ - ë°˜ë³µë¬¸
    Array.from(links).forEach( (link)=>{
      // ìš”ì†Œ í™•ì¸ í•´ë´„
      //console.log( link );
      // ìš”ì†Œ í•˜ë‚˜í•˜ë‚˜ì— í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡
      link.addEventListener('click', function (e) {
        console.log( this.dataset.page ); // í˜ì´ì§€ ë²ˆí˜¸
        document.getElementById("page").value = this.dataset.page;
        document.getElementById("searchForm").submit();
      } )
    } )

    // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì¡ì•„ì„œ ì²˜ë¦¬
    // 1. ê²€ìƒ‰ ë²„íŠ¼ì„ íŠ¹ì •í•´ì„œ, 
    const searchBtn = document.getElementById("searchBtn"); // ë‹¨ìˆ˜, ê°ì²´ëŠ” 1ê°œ
    // 2. í•´ë‹¹ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë“±ë¡(ì¬ì •ì˜) í•œë‹¤
    //    ì´ë²¤íŠ¸ëª… : 'click', ì‚¬ì „ì— ì •ì˜ë˜ì–´ìˆë‹¤
    //    í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒë˜ë©´ -> ì ì‹œí›„ì— -> ë¦¬ìŠ¤ë„ˆì— ë“±ë¡ëœ ì´ë²¤íŠ¸ ì²˜ë¦¬ í•¨ìˆ˜(ì½œë°±í•¨ìˆ˜)ê°€ 
    //    ìë™ìœ¼ë¡œ í˜¸ì¶œëœë‹¤
    searchBtn.addEventListener('click', function (e) {
      e.preventDefault();
      // í•˜ê³  ì‹¶ì€ ì‘ì—… ì§„í–‰
      console.log("ë²„í° í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬");
      // 2. ê²€ìƒ‰ì–´ ì…ë ¥íƒœê·¸ë¥¼ íŠ¹ì •í•´ì„œ, ê²€ìƒ‰ì–´ê°’ ì„¸íŒ…
      document.getElementById("keyword").value
        = document.getElementById("search_keyword").value
      // 3. í˜ì´ì§• ë²ˆí˜¸(ê°’) ì…ë ¥ íƒœê·¸ì— ì„¸íŒ…
      document.getElementById("page").value = 0;
      // 4. í¼íƒœê·¸ë¥¼ íŠ¹ì •í•´ì„œ ì„œë²„ì— ì „ì†¡(submit ì´ë°´íŠ¸(í–‰ìœ„) ì§„í–‰)
      document.getElementById("searchForm").submit();
      return false;
    })
    // í‘œì¤€í•¨ìˆ˜(í•¨ìˆ˜==ë©”ì†Œë“œ)
    /*
    ìë°”ì˜ í‘œì¤€ ë©”ì†Œë“œ ë¬¸ë²•
    [ëª¨ë””íŒŒì´ì–´(ì ‘ê·¼ì œì–´ì(private,..), ì¼ë°˜(final, staic, abstract,..))] 
    ë¦¬í„´íƒ€ì…(8+ë¬´í•œëŒ€+1) ë©”ì†Œë“œëª…(ì¸ì)  {
      [ìŠ¤í…Œì´íŠ¸ë¨¼íŠ¸];
      [return [ê°’]]; // []ìƒëµê°€ëŠ¥
    }

    ìë°”ìŠ¤í¬ë¦½íŠ¸
    function [í•¨ìˆ˜ëª…] (ì¸ì) {
      [ìŠ¤í…Œì´íŠ¸ë¨¼íŠ¸];
      [return [ê°’]];
    }
    */
  </script>
  </div>